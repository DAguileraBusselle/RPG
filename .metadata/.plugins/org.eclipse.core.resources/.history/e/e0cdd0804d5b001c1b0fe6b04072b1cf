package eventos;

import java.util.Random;
import java.util.Scanner;

import entidades.Monstruo;
import entidades.Objeto;
import entidades.ObjetoActivo;
import entidades.ObjetoPasivo;
import main.RPG;

public class encounter {

	Random rd = new Random();
	static Scanner sc = new Scanner(System.in);
	
	public Boolean decidirAccion(Monstruo mons) {
		boolean encounterDerrotado = false;
		boolean opcionValida = false;
		
		while(!opcionValida) {
			System.out.println("¿Que haras?\n\t1 - ATACAR\n\t2 - HUIR");
			String decision = sc.nextLine();
			
				switch (decision.toLowerCase()) {
			case "1":
				
				opcionValida = true;
				combate(mons);
				encounterDerrotado = true;
								
				break;
			case "2":
				
				opcionValida = true;
				
				break;
						
			default:
				System.out.println("Debe introducir una decision valida");
				break;
				
			}
				
				
		}
		
		
		return encounterDerrotado;
		
	}
	
	private void combate(Monstruo mons) {
		
				
		
		while(mons.getVida() > 0) {
			boolean defender = false;
			boolean opcionValida = false;
			while(!opcionValida) {
		
			System.out.println("Elige\n\t1 - ATACAR\n\t2 - DEFENDER");
			String decision = sc.nextLine();
			
				switch (decision.toLowerCase()) {
			case "1":
				mons.setVida(mons.getVida() - RPG.jugador.getDanio());	
				opcionValida = true;
				defender = false;
				break;
			case "2":				
				opcionValida = true;
				defender = true;
				break;
						
			default:
				System.out.println("Debe introducir una decision valida");
				break;
				
				}
				
				
			}
			System.out.println("______________________________________________");
			
			System.out.println("ATACAS AL " + mons.getClase().toUpperCase());
			
			System.out.println("JUGADOR: " + RPG.jugador.getVida() + "HP");
			System.out.println(mons.getClase() + ": " + mons.getVida() + "HP");	
			
			System.out.println("______________________________________________");
			
			
			if (defender) {
				System.out.println("DEFIENDES EL DAÑO");
			} else if (mons.getVida() > 0){
				System.out.println("ATACA EL " + mons.getClase().toUpperCase());
				RPG.jugador.setVida(RPG.jugador.getVida() - mons.getDanio());
			System.out.println("______________________________________________");
			
			System.out.println("JUGADOR: " + RPG.jugador.getVida() + "HP");
			System.out.println(mons.getClase() + ": " + mons.getVida() + "HP");
			} 
			
			if (RPG.jugador.getVida() <= 0) {
				for (int i = 0; i < 35; ++i) System.out.println();
				System.out.println("HAS MUERTO");
				for (int i = 0; i < 24; ++i) System.out.println();
				System.exit(0);
			}
			
			
		}
		
		int expMons = (mons.getNivel() * 2) + (RPG.PISO *10);
		RPG.EXPERIENCIA += expMons;
		System.out.println("CONSEGUISTE " + expMons + "EXP");
		RPG.CONT_MONSTRUOS_DERROTADOS++;
		sc.nextLine();
		
		if (RPG.EXPERIENCIA >= RPG.jugador.getNivel() * 100) {
			int expExtra = RPG.EXPERIENCIA - 100;
			RPG.jugador.setNivel(RPG.jugador.getNivel() + 1);
			RPG.VIDA_MAX += RPG.jugador.getNivel() * 50;
			RPG.jugador.setVida(RPG.VIDA_MAX);
			RPG.jugador.setDanio(RPG.jugador.getDanio() + (RPG.jugador.getNivel() * 5));
			RPG.EXPERIENCIA = 0 + expExtra;
			System.out.println("HAS SUBIDO A NIVEL " + RPG.jugador.getNivel());
			sc.nextLine();
		}
	}

	public Monstruo generarMonstruo() {
		Monstruo monstruo;
		String clase = Monstruo.clases[rd.nextInt(2 - 0) + 0];
		int vidaBase = 0;
		int danioBase = 0;
				
		switch (clase) {
			case "zombie":
				vidaBase = 75;
				danioBase = 15;
			break;
	
			case "esqueleto":
				vidaBase = 45;
				danioBase = 20;
			break;
			
			case "lagarto":
				vidaBase = 125;
				danioBase = 5;
			break;
		}
		
		
		int nivel = rd.nextInt((RPG.PISO*10) - (RPG.PISO*10 - 9)) + (RPG.PISO*10 - 9);
		
		int vida = nivel * 10 + vidaBase;
		int danio = nivel * 2 + danioBase;
		
		monstruo = new Monstruo(clase, nivel, vida, danio);
				
		return monstruo;
	}

	public static void decidirObjPas() {	
		
		//TODO: valancear de verdad el loot por pisos, esta en modo prueba
		
		Random rd = new Random();
		ObjetoPasivo objPas = null;
		if (RPG.PISO ==1) {
			objPas = RPG.listaObjPas.get(rd.nextInt(2 - 0) + 0);
		} else if (RPG.PISO ==2) {
			objPas = RPG.listaObjPas.get(rd.nextInt(5 - 3) + 3);
		} else if (RPG.PISO ==3) {
			objPas = RPG.listaObjPas.get(rd.nextInt(8 - 6) + 6);
		}
		
		
		Boolean opcionValida = false;
		
		while(!opcionValida) { 
			System.out.println("Te encuentras " + objPas.getNombre());
			System.out.println("Que desea hacer con el objeto?" + 
							"\n\t1_GUARDAR" +
							"\n\t2_OBSERVAR" +
							"\n\t3_TIRAR");
			
			String opcion = sc.nextLine();
			
				switch (opcion.toLowerCase()) {
			case "1":
				if(RPG.jugador.getInventario().getItemPas1() == null)	{
					RPG.jugador.getInventario().setItemPas1(objPas);
				} else if(RPG.jugador.getInventario().getItemPas2() == null)	{
					RPG.jugador.getInventario().setItemPas2(objPas);
				} else if(RPG.jugador.getInventario().getItemPas3() == null)	{
					RPG.jugador.getInventario().setItemPas3(objPas);
				} else if(RPG.jugador.getInventario().getItemPas4() == null)	{
					RPG.jugador.getInventario().setItemPas4(objPas);
				} else {
					maxObjetosPas(objPas);
				}
				opcionValida = true;							
				break;
			case "2":
				System.out.println(objPas.getDescripcion());
				opcionValida = true;
				break;
			case "3":				
				opcionValida = true;				
				break;
			
			default:
				System.out.println("Debe introducir una opcion valida");
				break;
				
			}
		}
		
		
		
		
	}

	private static void maxObjetosPas(ObjetoPasivo objPas) {
		Boolean opcionValida = false;
		
		while(!opcionValida) { 
			System.out.println("No puedes llevar mas objetos equipables");
			System.out.println("Que desea hacer con el objeto?" + 
							"\n\t1_Sustituir " + RPG.jugador.getInventario().getItemPas1().getNombre() +
							"\n\t2_Sustituir " + RPG.jugador.getInventario().getItemPas2().getNombre() +
							"\n\t3_Sustituir " + RPG.jugador.getInventario().getItemPas3().getNombre() +
							"\n\t4_Sustituir " + RPG.jugador.getInventario().getItemPas4().getNombre() +
							"\n\t5_TIRAR");
			
			String opcion = sc.nextLine();
			
				switch (opcion.toLowerCase()) {
			case "1":
				RPG.jugador.getInventario().setItemPas1(objPas);
				opcionValida = true;							
				break;
			case "2":
				RPG.jugador.getInventario().setItemPas2(objPas);
				opcionValida = true;
				break;
			case "3":
				RPG.jugador.getInventario().setItemPas3(objPas);	
				opcionValida = true;				
				break;
			case "4":
				RPG.jugador.getInventario().setItemPas4(objPas);
				opcionValida = true;
				break;
			case "5":
				opcionValida = true;
				break;
			default:
				System.out.println("Debe introducir una opcion valida");
				break;
				
			}
		}
		
	}

	public static void decidirObjAct() {
		Random rd = new Random();
		
		ObjetoActivo objAct = generarPocion();		
		String[] tiposPocion = new String[] {"simple", "media", "fuerte"};
		
		String nombre  = "pocion " + tiposPocion[rd.nextInt(2 - 0) + 0];
		 
		
		Boolean opcionValida = false;
		
		while(!opcionValida) { 
			System.out.println("Te encuentras " + nombre);
			System.out.println("Que desea hacer con el objeto?" + 
							"\n\t1_GUARDAR" +
							"\n\t2_OBSERVAR" +
							"\n\t3_TIRAR");
			
			String opcion = sc.nextLine();
			
				switch (opcion.toLowerCase()) {
			case "1":
				if (RPG.jugador.getInventario().getItem1().getNombre().equals(objAct.getNombre())) {
					RPG.jugador.getInventario().getItem1().setCantidad(RPG.jugador.getInventario().getItem1().getCantidad() + objAct.getCantidad());
				} else if (RPG.jugador.getInventario().getItem2().getNombre().equals(objAct.getNombre())) {
					RPG.jugador.getInventario().getItem2().setCantidad(RPG.jugador.getInventario().getItem2().getCantidad() + objAct.getCantidad());
				} else if (RPG.jugador.getInventario().getItem3().getNombre().equals(objAct.getNombre())) {
					RPG.jugador.getInventario().getItem3().setCantidad(RPG.jugador.getInventario().getItem3().getCantidad() + objAct.getCantidad());
				} else if (RPG.jugador.getInventario().getItem4().getNombre().equals(objAct.getNombre())) {
					RPG.jugador.getInventario().getItem4().setCantidad(RPG.jugador.getInventario().getItem4().getCantidad() + objAct.getCantidad());
				} else if (RPG.jugador.getInventario().getItem5().getNombre().equals(objAct.getNombre())) {
					RPG.jugador.getInventario().getItem5().setCantidad(RPG.jugador.getInventario().getItem5().getCantidad() + objAct.getCantidad());
				} else {
					maxObjetosAct(objAct);
				}
				opcionValida = true;							
				break;
			case "2":
				System.out.println(objAct.getDescripcion());
				opcionValida = true;
				break;
			case "3":				
				opcionValida = true;				
				break;
			
			default:
				System.out.println("Debe introducir una opcion valida");
				break;
				
			}
		}
		
	}

	private static void maxObjetosAct(ObjetoActivo objAct) {
		Boolean opcionValida = false;
		
		while(!opcionValida) { 
			System.out.println("No puedes llevar mas objetos consumibles");
			System.out.println("Que desea hacer con el objeto?" +
							"\n\t1_Sustituir " + RPG.jugador.getInventario().getItem1().getNombre() +
							"\n\t2_Sustituir " + RPG.jugador.getInventario().getItem2().getNombre() +
							"\n\t3_Sustituir " + RPG.jugador.getInventario().getItem3().getNombre() +
							"\n\t4_Sustituir " + RPG.jugador.getInventario().getItem4().getNombre() +
							"\n\t5_Sustituir " + RPG.jugador.getInventario().getItem5().getNombre() +
							"\n\t6_TIRAR");
			
			String opcion = sc.nextLine();
			
				switch (opcion.toLowerCase()) {
			case "1":
				RPG.jugador.getInventario().setItem1(objAct);
				opcionValida = true;							
				break;
			case "2":
				RPG.jugador.getInventario().setItem2(objAct);
				opcionValida = true;
				break;
			case "3":
				RPG.jugador.getInventario().setItem3(objAct);	
				opcionValida = true;				
				break;
			case "4":
				RPG.jugador.getInventario().setItem4(objAct);
				opcionValida = true;
				break;
			case "5":
				RPG.jugador.getInventario().setItem5(objAct);
				opcionValida = true;
				break;
			case "6":
				opcionValida = true;
				break;
			default:
				System.out.println("Debe introducir una opcion valida");
				break;
				
			}
		}
		
	}

	private static ObjetoActivo generarPocion() {		
		Random rd = new Random();
		String[] tiposPocion = new String[] {"simple", "media", "fuerte"};
		
		String nombre  = "pocion " + tiposPocion[rd.nextInt(2 - 0) + 0];
		
		int intensidad = 0;
		if (nombre.equals("pocion simple")) {
			intensidad = 50;
		} else if (nombre.equals("pocion media")) {
			intensidad = 150;
		} else {
			intensidad = 300;
		}
		
		String descripcion = "cura " + intensidad + " puntos de vida";
		
		int cantidad = 0;
		if (nombre.equals("pocion simple")) {
			cantidad = rd.nextInt(RPG.PISO* 10 - RPG.PISO) - RPG.PISO;
		} else if (nombre.equals("pocion media")) {
			cantidad = rd.nextInt(RPG.PISO* 2 - RPG.PISO) - RPG.PISO;
		} else {
			cantidad = 1;
		}
		
		
		
		ObjetoActivo objAct = new ObjetoActivo(nombre, descripcion, "cura", intensidad, cantidad);	
		
		return objAct;
	}
}
